<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/general.css">

    <title>Receiver</title>
</head>
<body>
    <h1>Receiver</h1>
    <script>
        // Get the broadcast channel ID from the URL
        const urlParams = new URLSearchParams(window.location.search);
        const channelId = urlParams.get('channel');

        // Use the channel ID to create a unique signaling channel
        const signalingChannel = new SignalingChannel(channelId);

        const configuration = {'iceServers': [{'urls': 'stun:stun.l.google.com:19302'}]};
        const peerConnection = new RTCPeerConnection(configuration);

        signalingChannel.addEventListener('message', async message => {
            if (message.offer) {
                await peerConnection.setRemoteDescription(new RTCSessionDescription(message.offer));
                const answer = await peerConnection.createAnswer();
                await peerConnection.setLocalDescription(answer);
                signalingChannel.send({'answer': answer});
            }
        });
    </script>
</body>
</html>
